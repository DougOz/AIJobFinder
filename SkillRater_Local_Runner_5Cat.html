<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- CRITICAL: Ensures the layout is fully responsive on all devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skill Rater with Public Profiles (5 Levels)</title>

    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Configure Tailwind to use the Inter font -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        // Custom color scale for the 5 rating levels
                        'level-1': '#93c5fd', // Blue-300
                        'level-2': '#60a5fa', // Blue-400
                        'level-3': '#3b82f6', // Blue-500
                        'level-4': '#2563eb', // Blue-600
                        'level-5': '#1d4ed8', // Blue-700
                    }
                },
            }
        }
    </script>

    <!--
        *** ESSENTIAL CONFIG FALLBACK ***
        Ensures the global Firebase variables are defined,
        falling back to mock data if the environment hasn't provided them.
    -->
    <script>
        // Check if environment variables are defined, otherwise use local mock data
        var __app_id = typeof __app_id !== 'undefined' ? __app_id : 'local-skill-rater-id';
        var __firebase_config = typeof __firebase_config !== 'undefined' ? __firebase_config : JSON.stringify({
            apiKey: "AIzaSyAl9XTwvGvyFch7kdB79UHF0iG6Rnxk90Q",
            authDomain: "aijobfinder-9dd90.firebaseapp.com",
            projectId: "aijobfinder-9dd90",
            storageBucket: "aijobfinder-9dd90.firebasestorage.app",
            messagingSenderId: "942806226439",
            appId: "1:942806226439:web:b0e46f0bf083598fc9fca2",
            measurementId: "G-9ZPLQXM1BJ"
        });
        var __initial_auth_token = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
    </script>

    <!-- Load React and ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Load Babel for JSX transpilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!--
        Load Firebase/Firestore/Auth CDNs.
        These functions are loaded as modules and exposed globally.
    -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, setDoc, doc, onSnapshot, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Expose Firebase functions globally for use in the type="text/babel" script block
        window.firebase_app_f = initializeApp;
        window.firebase_auth_f = { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged };
        window.firebase_firestore_f = { getFirestore, setDoc, doc, onSnapshot, setLogLevel };
    </script>

    <style>
        /* Custom CSS for a clean, centered layout */
        #root {
            min-height: 100vh;
            display: flex;
            align-items: flex-start;
            justify-content: center;
            padding: 1rem;
            background-color: #f8fafc; /* slate-50 */
        }
        /* Custom scrollbar styling for a nicer look */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #6366f1; /* indigo-500 */
            border-radius: 4px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background-color: #e0e7ff; /* indigo-100 */
        }
    </style>
</head>
<body class="font-sans">

    <!-- The root element where the React application will be mounted -->
    <div id="root">
        <!-- A simple loading message until React mounts -->
        <p class="text-gray-500">Loading React Application...</p>
    </div>

    <!-- The main script block containing the React component code -->
    <script type="text/babel">
        const { useState, useEffect, useCallback, useMemo } = React;

        // --- Custom SVG Icons (Replacement for lucide-react imports) ---
        const Search = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
        );

        // --- Core App Component (Skill Rater Logic) ---

        function App() {
            // Firebase States
            const [db, setDb] = useState(null);
            const [auth, setAuth] = useState(null);
            const [userId, setUserId] = useState(null);

            // --- Configuration Retrieval ---
            const rawConfig = typeof __firebase_config !== 'undefined' ? __firebase_config : '{}';

            const firebaseConfig = useMemo(() => {
                try {
                    const parsed = rawConfig ? JSON.parse(rawConfig) : {};
                    return Object.keys(parsed).length > 0 ? parsed : null;
                } catch (e) {
                    console.error("Error parsing __firebase_config. Raw config was:", rawConfig, "Error:", e);
                    return null;
                }
            }, [rawConfig]);

            const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
            const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

            // Other States
            const [isAuthReady, setIsAuthReady] = useState(false);
            const [raterName, setRaterName] = useState('Default'); // Rater profile name
            const [masterSkillItems, setMasterSkillItems] = useState([]);
            const [userRatings, setUserRatings] = useState({});

            const [searchInput, setSearchInput] = useState('');
            const [activeSearchTerm, setActiveSearchTerm] = useState(''); // Only this triggers filtering

            const [isLoading, setIsLoading] = useState(true);
            const [saveMessage, setSaveMessage] = useState(null);

            // --- Pagination and Filter States ---
            const [currentPage, setCurrentPage] = useState(1);
            const skillsPerPage = 50;
            const [showUnratedOnly, setShowUnratedOnly] = useState(false);
            // -----------------------------------------

            // 1. Firebase Initialization and Authentication Listener
            useEffect(() => {
                if (!window.firebase_app_f || !window.firebase_auth_f || !window.firebase_firestore_f) {
                    console.error("Firebase global functions are not available. Check CDN loading.");
                    setIsLoading(false);
                    return;
                }

                if (!firebaseConfig) {
                    console.error("Firebase configuration is missing or invalid after parsing. Cannot proceed with initialization.");
                    setIsLoading(false);
                    return;
                }

                const { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } = window.firebase_auth_f;
                const { getFirestore, setLogLevel } = window.firebase_firestore_f;

                try {
                    const app = window.firebase_app_f(firebaseConfig);
                    const firestoreDb = getFirestore(app);
                    const firebaseAuth = getAuth(app);

                    setDb(firestoreDb);
                    setAuth(firebaseAuth);

                    setLogLevel('debug');
                    console.log("Firebase initialized successfully. Firestore logging set to 'debug'.");

                    const authenticate = async () => {
                        try {
                            if (initialAuthToken) {
                                await signInWithCustomToken(firebaseAuth, initialAuthToken);
                                console.log("Attempting sign in with custom token.");
                            } else {
                                await signInAnonymously(firebaseAuth);
                                console.log("No custom auth token provided by the environment. Attempting anonymous sign in.");
                            }
                        } catch (error) {
                            console.error("Initial authentication failed (Expected with mock config):", error);
                        }
                    };

                    authenticate();

                    // Listener to determine final user state and set AuthReady flag
                    const unsubscribe = onAuthStateChanged(firebaseAuth, (user) => {
                        if (user && user.uid) {
                            setUserId(user.uid);
                            console.log(`User authenticated. UID: ${user.uid}`);
                        } else {
                            // If unauthenticated (or failed auth), assign a unique ID for temporary session data
                            setUserId(crypto.randomUUID());
                            console.warn("User is not authenticated (or auth failed). Using a random session ID.");
                        }
                        setIsAuthReady(true);
                        // Data loading starts in the next effect when isAuthReady is true
                    });

                    return () => unsubscribe();

                } catch (e) {
                    console.error("Error during Firebase initialization or authentication:", e);
                    setIsLoading(false);
                }
            }, [initialAuthToken, firebaseConfig]);

            // Function to handle fetching and setting up snapshot for the Rater Profile
            const fetchRaterRatings = useCallback(() => {
                const currentRaterName = raterName.trim();

                if (!isAuthReady || !db || !currentRaterName) {
                    console.log("Skipping fetchRaterRatings: dependencies missing.");
                    if (isAuthReady && !db) setIsLoading(false);
                    return () => {};
                }

                if (currentRaterName === '') {
                    console.warn("Rater name is empty. Cannot load ratings.");
                    setUserRatings({});
                    return () => {};
                }

                const { doc, onSnapshot } = window.firebase_firestore_f;

                // Path: /artifacts/{appId}/public/data/skill_ratings/{raterName}
                const ratingsDocRef = doc(db, 'artifacts', appId, 'public', 'data', 'skill_ratings', currentRaterName);
                console.log(`Setting up rating snapshot for Rater: ${currentRaterName} at path: ${ratingsDocRef.path}`);

                setIsLoading(true); // Indicate data fetch is starting

                const unsubscribeRatings = onSnapshot(ratingsDocRef, (docSnapshot) => {
                    if (docSnapshot.exists()) {
                        setUserRatings(docSnapshot.data().ratings || {});
                        console.log(`Fetched ratings for ${currentRaterName}. Total rated: ${Object.keys(docSnapshot.data().ratings || {}).length}`);
                    } else {
                        setUserRatings({});
                        console.log(`No ratings found for ${currentRaterName}. Starting fresh.`);
                    }
                    setIsLoading(false); // Stop loading once data is received
                }, (error) => {
                    console.error(`Error fetching ratings for ${currentRaterName}:`, error);
                    setUserRatings({});
                    setIsLoading(false);
                });

                return unsubscribeRatings;
            }, [isAuthReady, db, appId, raterName]); // raterName triggers refetch

            // Handle button click for explicit reload
            const handleReloadRatings = () => {
                if (!raterName || raterName.trim() === '') {
                    setSaveMessage({ type: 'error', text: 'Rater Profile Name cannot be empty.' });
                    setTimeout(() => setSaveMessage(null), 3000);
                    return;
                }
                // Call the function explicitly
                fetchRaterRatings();
            };


            // 2. Data Fetching Effects (Master Skills & Rater Profile)

            // 2a. Fetch Master Skills (Public, static collection)
            useEffect(() => {
                if (!isAuthReady || !db) return;

                const { doc, onSnapshot } = window.firebase_firestore_f;

                // Path: /artifacts/{appId}/public/all_skills (Master list)
                const masterDocPath = doc(db, 'artifacts', appId, 'public', 'all_skills');
                const unsubscribeMaster = onSnapshot(masterDocPath, (docSnapshot) => {
                    if (docSnapshot.exists() && docSnapshot.data().list) {
                        const skills = docSnapshot.data().list
                            .map(item => ({
                                skill: item.skill,
                                count: item.count || 0, // Ensure count is a number
                            }))
                            .sort((a, b) => b.count - a.count);

                        setMasterSkillItems(skills);
                        console.log(`Fetched ${skills.length} unique skills (with counts) from Firestore.`);
                    } else {
                        setMasterSkillItems([]);
                    }
                }, (error) => {
                    console.error("Error fetching master skills:", error);
                });

                return () => unsubscribeMaster();
            }, [isAuthReady, db, appId]);


            // 2b. Fetch User Ratings (Public, dynamic by raterName)
            useEffect(() => {
                // This effect runs on component mount, or when fetchRaterRatings dependencies (including raterName) change.
                const unsubscribe = fetchRaterRatings();
                return () => unsubscribe;
            }, [fetchRaterRatings]); // Dependency on the memoized fetch function

            // 3. Save Function
            const saveUserRating = useCallback(async (skill, rating) => {

                const { setDoc, doc } = window.firebase_firestore_f;
                const currentRaterName = raterName.trim();

                if (!isAuthReady || !db || !userId) {
                    setSaveMessage({ type: 'error', text: 'Authentication not complete. Cannot save.' });
                    setTimeout(() => setSaveMessage(null), 3000);
                    return;
                }

                if (!currentRaterName) {
                    setSaveMessage({ type: 'error', text: 'Rater Profile Name cannot be empty.' });
                    setTimeout(() => setSaveMessage(null), 4000);
                    return;
                }

                // Path: /artifacts/{appId}/public/data/skill_ratings/{raterName}
                const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'skill_ratings', currentRaterName);

                // 1. Prepare the full ratings object to be saved
                const updatedRatings = { ...userRatings, [skill]: rating };

                // Handle rating of 0 (unrated/cleared)
                if (rating === 0) {
                    delete updatedRatings[skill];
                }

                // 2. Optimistically update local state for responsiveness
                setUserRatings(updatedRatings);

                try {
                    // 3. Save the full, updated ratings map to Firestore
                    await setDoc(docRef, {
                        // Store the user ID who created/modified this public profile for auditing
                        creatorUserId: userId,
                        lastUpdated: new Date(),
                        ratings: updatedRatings // Use the calculated updated map
                    }, { merge: false }); // Overwrite the whole ratings object

                    setSaveMessage({ type: 'success', text: `Saved rating for ${skill} to profile: ${currentRaterName}` });

                } catch (e) {
                    console.error("Error saving user rating:", e);
                    // Clearer message for the user that the save failed due to permission/auth issues
                    setSaveMessage({
                        type: 'error',
                        text: `Save failed: Permission denied. (Check console for Firebase details)`
                    });
                }

                setTimeout(() => setSaveMessage(null), 3000);
            }, [isAuthReady, db, userId, appId, userRatings, raterName]); // raterName is now a required dependency

            // --- Combined Filtering and Pagination Logic ---
            const skillsToDisplay = useMemo(() => {
                // 1. Start with the full list of skill items (objects: {skill: string, count: number})
                let list = masterSkillItems.filter(item =>
                    // Use activeSearchTerm for filtering
                    item.skill.toLowerCase().includes(activeSearchTerm.toLowerCase())
                );

                // 2. Apply "Unrated Only" Filter
                if (showUnratedOnly) {
                    // Filter based on the skill name found in the item object
                    // Only include skills NOT found in userRatings or where rating is 0
                    list = list.filter(item => !userRatings[item.skill] || userRatings[item.skill] === 0);
                }

                return list;
            }, [masterSkillItems, activeSearchTerm, showUnratedOnly, userRatings]); // Dependency updated to activeSearchTerm

            // Pagination calculations
            const totalPages = Math.ceil(skillsToDisplay.length / skillsPerPage);
            const startIndex = (currentPage - 1) * skillsPerPage;
            const paginatedSkills = skillsToDisplay.slice(startIndex, startIndex + skillsPerPage);

            // Function to change page
            const goToPage = useCallback((page) => {
                if (page >= 1 && page <= totalPages) {
                    setCurrentPage(page);
                }
            }, [totalPages]);

            // Reset page when filters change (using activeSearchTerm)
            useEffect(() => {
                if (currentPage !== 1) {
                    setCurrentPage(1);
                }
            }, [activeSearchTerm, showUnratedOnly]);
            // ---------------------------------------------------


            // 5. Custom 5-Level Rating Component (Updated)
            const StarRating = ({ skill, currentRating, onRate }) => {
                // Map the 5 levels to user-friendly text for context
                const levels = {
                    1: 'Aware',
                    2: 'Beginner',
                    3: 'Proficient',
                    4: 'Advanced',
                    5: 'Master'
                };

                // Tailwind colors based on rating value
                const getRatingClass = (value) => {
                    const base = 'px-3 py-1 text-xs font-semibold rounded-full transition-all duration-200 shadow-md transform active:scale-95 border';

                    if (value <= currentRating) {
                        // Color gets progressively darker indigo/blue
                        const colorMap = {
                            1: 'bg-indigo-300 text-indigo-900 hover:bg-indigo-400 border-indigo-500',
                            2: 'bg-indigo-400 text-white hover:bg-indigo-500 border-indigo-600',
                            3: 'bg-indigo-500 text-white hover:bg-indigo-600 border-indigo-700',
                            4: 'bg-indigo-600 text-white hover:bg-indigo-700 border-indigo-800',
                            5: 'bg-indigo-700 text-white hover:bg-indigo-800 border-indigo-900',
                        };
                        return `${base} ${colorMap[value]} ${value === currentRating ? 'ring-2 ring-offset-2 ring-indigo-500' : ''}`;
                    } else {
                        // Unrated look
                        return `${base} bg-gray-100 text-gray-600 hover:bg-indigo-50 hover:text-indigo-600 border-gray-200`;
                    }
                };

                return (
                    <div className="flex items-center space-x-1 sm:space-x-1.5 flex-wrap justify-end">
                        {[1, 2, 3, 4, 5].map((value) => ( // Loop 5 times
                            <button
                                key={value}
                                title={`${levels[value]} (${value} of 5). Click again to unrate.`}
                                // Toggle logic: If already rated that value, set to 0 (unrated). Otherwise, set new value.
                                onClick={() => onRate(skill, value === currentRating ? 0 : value)}
                                className={getRatingClass(value)}
                            >
                                {levels[value]}
                            </button>
                        ))}
                        {/* Optional unrate button for clarity */}
                        {currentRating > 0 && (
                             <button
                                title="Clear Rating"
                                onClick={() => onRate(skill, 0)}
                                className="ml-2 px-2 py-1 text-xs font-medium rounded-full text-red-600 bg-red-100 hover:bg-red-200 transition duration-150 transform active:scale-95 shadow-sm border border-red-200"
                            >
                                Clear
                            </button>
                        )}
                    </div>
                );
            };

            // --- Render Logic ---
            if (isLoading) {
                return (
                    <div className="flex items-center justify-center min-h-screen w-full">
                        <div className="animate-spin rounded-full h-12 w-12 border-b-4 border-indigo-500"></div>
                        <p className="ml-4 text-lg text-gray-700">Loading application and data...</p>
                    </div>
                );
            }

            return (
                <div className="w-full max-w-5xl bg-white shadow-2xl rounded-3xl p-6 sm:p-10 my-8 border border-gray-200 transition-all duration-300">

                    {/* Header: Fancier Look */}
                    <h1 className="text-3xl sm:text-4xl font-extrabold text-gray-900 mb-2 border-b-4 border-indigo-100 pb-3">
                        <span className="text-indigo-600">Skill Profile</span> Editor
                    </h1>
                    <p className="text-md text-gray-600 mb-2">
                        Rate your expertise using the **5-level scale** below. All ratings are saved publicly to the specified profile.
                    </p>
                    <p className="text-sm text-gray-500 mb-6 border-b border-gray-100 pb-4">
                        1 (Aware), 2 (Beginner), 3 (Proficient), 4 (Advanced), 5 (Master).
                        <span className="block mt-2 text-xs text-gray-400">
                            Your temporary Firebase ID: <span className="font-mono bg-gray-100 px-1 rounded-md text-gray-600">{userId || 'N/A'}</span>
                        </span>
                    </p>

                    {/* Rater Profile Input, Reload Button & Save Message */}
                    <div className="flex flex-col gap-3 md:flex-row justify-between items-start md:items-center mb-6 p-4 bg-indigo-50 rounded-xl shadow-lg border border-indigo-200">

                        <div className="flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-3 w-full md:w-auto md:flex-grow">
                            <label htmlFor="rater-name" className="text-sm font-bold text-indigo-700 whitespace-nowrap">
                                Active Profile:
                            </label>
                            <input
                                id="rater-name"
                                type="text"
                                value={raterName}
                                onChange={(e) => setRaterName(e.target.value)}
                                placeholder="e.g. Front-End Team 2024"
                                className="w-full sm:w-auto flex-grow px-4 py-2 border-2 border-indigo-300 rounded-xl text-base shadow-inner focus:ring-4 focus:ring-indigo-500 focus:border-indigo-500 transition"
                                style={{ minWidth: '200px' }}
                            />
                            <button
                                onClick={handleReloadRatings}
                                className="w-full sm:w-auto px-6 py-2.5 text-sm font-bold rounded-xl text-white bg-indigo-600 hover:bg-indigo-700 transition duration-150 shadow-xl whitespace-nowrap active:shadow-none active:translate-y-px transform"
                            >
                                Load/Switch Profile
                            </button>
                        </div>

                        {saveMessage && (
                            <div className={`mt-3 md:mt-0 px-4 py-2 text-sm font-bold rounded-full shadow-lg ${
                                saveMessage.type === 'success' ? 'bg-green-100 text-green-800 border border-green-300' : 'bg-red-100 text-red-800 border border-red-300'
                            }`}>
                                {saveMessage.text}
                            </div>
                        )}
                    </div>

                    {/* Search Bar, Search Button, and Unrated Toggle */}
                    <div className="flex flex-col lg:flex-row gap-4 mb-8">
                        {/* Search Input and Button container */}
                        <div className="relative flex-grow flex shadow-lg rounded-xl">
                            <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none" />
                            <input
                                type="text"
                                placeholder={`Search skills... (Total filtered: ${skillsToDisplay.length})`}
                                className="w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-l-xl focus:outline-none focus:ring-4 focus:ring-indigo-500 transition duration-150 shadow-inner text-base"
                                value={searchInput}
                                onChange={(e) => setSearchInput(e.target.value)}
                                onKeyDown={(e) => {
                                    if (e.key === 'Enter') {
                                        setActiveSearchTerm(searchInput); // Trigger filter on Enter
                                    }
                                }}
                            />
                            {/* New Search Button */}
                            <button
                                onClick={() => setActiveSearchTerm(searchInput)}
                                className="px-6 py-3 text-sm font-bold rounded-r-xl text-white bg-indigo-600 hover:bg-indigo-700 transition duration-150 shadow-md whitespace-nowrap active:shadow-none active:translate-y-px"
                            >
                                Apply Filter
                            </button>
                        </div>

                        {/* Checkbox for Unrated Skills - Styled for fancier look */}
                        <label htmlFor="unrated-toggle" className="flex items-center justify-center cursor-pointer p-3 bg-white rounded-xl border-2 border-gray-200 shadow-md transition duration-150 hover:border-indigo-500 hover:shadow-lg lg:w-1/4 min-w-[200px]">
                            <input
                                id="unrated-toggle"
                                type="checkbox"
                                checked={showUnratedOnly}
                                onChange={() => setShowUnratedOnly(prev => !prev)}
                                className="form-checkbox h-5 w-5 text-indigo-600 rounded-full border-gray-300 focus:ring-indigo-500"
                            />
                            <span className="ml-3 text-sm font-bold text-gray-700 whitespace-nowrap">
                                Show Unrated Skills Only
                            </span>
                        </label>
                    </div>


                    {/* Skills List */}
                    <div className="space-y-2 custom-scrollbar max-h-[60vh] overflow-y-auto pr-3">
                        {paginatedSkills.length > 0 ? (
                            paginatedSkills.map((item) => (
                                <div
                                    key={item.skill}
                                    className="flex flex-col lg:flex-row justify-between items-start lg:items-center py-4 px-5 bg-white hover:bg-indigo-50 rounded-xl transition duration-150 border border-gray-100 shadow-sm hover:shadow-md"
                                >
                                    <div className="flex flex-wrap items-center space-x-3 mb-2 lg:mb-0 lg:w-1/3">
                                        <span className="text-base font-semibold text-gray-800">{item.skill}</span>
                                        {/* Display the skill count */}
                                        <span title="Total times this skill was found" className="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800 shadow-inner">
                                            Count: {item.count.toLocaleString()}
                                        </span>
                                    </div>
                                    <div className="lg:w-2/3 flex justify-start lg:justify-end">
                                        <StarRating
                                            skill={item.skill}
                                            currentRating={userRatings[item.skill] || 0}
                                            onRate={saveUserRating}
                                        />
                                    </div>
                                </div>
                            ))
                        ) : (
                            <div className="text-center p-12 text-gray-500 italic bg-gray-50 rounded-xl border border-gray-200 shadow-inner">
                                {activeSearchTerm && skillsToDisplay.length === 0 ?
                                    `No skills found matching "${activeSearchTerm}" or all filtered skills are rated.` :
                                    "Loading master skills..."
                                }
                            </div>
                        )}
                    </div>

                    {/* Pagination Controls */}
                    {skillsToDisplay.length > skillsPerPage && (
                        <div className="flex flex-col sm:flex-row justify-between items-center mt-6 pt-4 border-t border-gray-200">
                            <p className="text-sm text-gray-600 mb-4 sm:mb-0">
                                Displaying skills <span className="font-bold text-indigo-700">{startIndex + 1}</span> to <span className="font-bold text-indigo-700">{Math.min(startIndex + skillsPerPage, skillsToDisplay.length)}</span> of <span className="font-bold text-indigo-700">{skillsToDisplay.length}</span> total filtered skills.
                            </p>
                            <div className="flex space-x-2">
                                <button
                                    onClick={() => goToPage(currentPage - 1)}
                                    disabled={currentPage === 1}
                                    className="flex items-center px-4 py-2 text-sm font-medium text-indigo-600 bg-indigo-50 rounded-xl shadow-md hover:bg-indigo-100 disabled:opacity-50 disabled:cursor-not-allowed transition active:shadow-none active:translate-y-px"
                                >
                                    <span className="mr-1">&larr;</span> Previous
                                </button>
                                <div className="flex items-center text-sm font-bold text-gray-700 px-4 border border-gray-300 rounded-xl bg-gray-100 shadow-inner">
                                    Page <span className="ml-1">{currentPage}</span> of <span className="ml-1">{totalPages}</span>
                                </div>
                                <button
                                    onClick={() => goToPage(currentPage + 1)}
                                    disabled={currentPage === totalPages || totalPages === 0}
                                    className="flex items-center px-4 py-2 text-sm font-bold text-white bg-indigo-600 rounded-xl shadow-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition active:shadow-none active:translate-y-px"
                                >
                                    Next <span className="ml-1">&rarr;</span>
                                </button>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
